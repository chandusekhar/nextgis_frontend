!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("ol/proj"),require("ol/layer/Tile"),require("ol"),require("ol/control"),require("ol/extent"),require("ol/format"),require("ol/geom/Polygon"),require("ol/source/ImageWMS"),require("ol/layer/Image"),require("events"),require("ol/source/OSM"),require("ol/geom/Point"),require("ol/Feature"),require("ol/layer"),require("ol/source/Vector"),require("ol/source/XYZ")):"function"==typeof define&&define.amd?define(["ol/proj","ol/layer/Tile","ol","ol/control","ol/extent","ol/format","ol/geom/Polygon","ol/source/ImageWMS","ol/layer/Image","events","ol/source/OSM","ol/geom/Point","ol/Feature","ol/layer","ol/source/Vector","ol/source/XYZ"],t):"object"==typeof exports?exports.OlMapAdapter=t(require("ol/proj"),require("ol/layer/Tile"),require("ol"),require("ol/control"),require("ol/extent"),require("ol/format"),require("ol/geom/Polygon"),require("ol/source/ImageWMS"),require("ol/layer/Image"),require("events"),require("ol/source/OSM"),require("ol/geom/Point"),require("ol/Feature"),require("ol/layer"),require("ol/source/Vector"),require("ol/source/XYZ")):e.OlMapAdapter=t(e["ol/proj"],e["ol/layer/Tile"],e.ol,e["ol/control"],e["ol/extent"],e["ol/format"],e["ol/geom/Polygon"],e["ol/source/ImageWMS"],e["ol/layer/Image"],e.events,e["ol/source/OSM"],e["ol/geom/Point"],e["ol/Feature"],e["ol/layer"],e["ol/source/Vector"],e["ol/source/XYZ"])}(window,function(e,t,r,o,n,i,a,u,s,l,c,p,f,y,d,m){return function(e){var t={};function r(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(o,n,function(t){return e[t]}.bind(null,n));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=16)}([function(t,r){t.exports=e},function(e,r){e.exports=t},function(e,t){e.exports=r},function(e,t){e.exports=o},function(e,t){e.exports=n},function(e,t){e.exports=i},function(e,t){e.exports=a},function(e,t){e.exports=u},function(e,t){e.exports=s},function(e,t){e.exports=l},function(e,t){e.exports=c},function(e,t){e.exports=p},function(e,t){e.exports=f},function(e,t){e.exports=y},function(e,t){e.exports=d},function(e,t){e.exports=m},function(e,t,r){"use strict";r.r(t);var o=r(2),n=r(0),i=r(3),a=r(4),u=r(5),s=r(6),l=r(7),c=r.n(l),p=r(8),f=r.n(p),y=1,d=function(){function e(){}return e.prototype.addLayer=function(e){this.name=e.id||"image-"+y++;var t={url:e.url,params:{resource:e.resourceId||e.id},ratio:1};e.updateWmsParams&&(t.imageLoadFunction=function(t,r){var o=r.split("?")[0],n=function(e){for(var t,r,o=decodeURIComponent,n=e.split("&"),i={},a=0,u=n.length,s=void 0;a<u;++a)if((s=n[a]).length){var l=s.indexOf("=");l<0?(t=o(s),r=""):(t=o(s.slice(0,l)),r=o(s.slice(l+1))),"string"==typeof i[t]&&(i[t]=[i[t]]),Array.isArray(i[t])?i[t].push(r):i[t]=r}return i}(r.split("?")[1]),i=n.resource,a=n.BBOX,u=n.WIDTH,s=n.HEIGHT,l=function e(t,r){var o=[];var n;for(n in t)if(t.hasOwnProperty(n)){var i=r?r+"["+n+"]":n,a=t[n];o.push(null!==a&&"object"==typeof a?e(a,i):encodeURIComponent(i)+"="+encodeURIComponent(a))}return o.join("&")}(e.updateWmsParams({resource:i,bbox:a,width:u,height:s}));t.getImage().src=o+"?"+l});var r=new c.a(t),o=new f.a({source:r});return this.layer=o,o},e}();var m=r(9),h=r(10),g=r.n(h),v=r(1),x=r.n(v),L=function(){function e(){this.name="osm"}return e.prototype.addLayer=function(e){return new x.a({source:new g.a})},e}(),b=r(11),P=r.n(b),j=r(12),O=r.n(j),q=r(13),w=r(14),M=r.n(w),_=1,I=function(){function e(){}return e.prototype.addLayer=function(e){this.name=e.id||"marker-"+_++;var t=e.latLng,r=t.lat,o=t.lng,i=new O.a({geometry:new P.a(Object(n.fromLonLat)([o,r]))}),a=new M.a({features:[i]});return new q.Vector({source:a})},e}(),S=r(15),A=r.n(S),T=1,C=function(){function e(){}return e.prototype.addLayer=function(e){return this.name=e.id||"tile-"+T++,new x.a({source:new A.a({url:e.url})})},e}(),E=function(){return(E=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},V=function(){function e(){this.layerAdapters=e.layerAdapters,this.displayProjection="EPSG:3857",this.lonlatProjection="EPSG:4326",this.emitter=new m.EventEmitter,this._layers={},this._baseLayers=[],this._order=0,this._length=9999,this.DPI=1e3/39.37/.28,this.IPM=39.37}return e.prototype.create=function(e){void 0===e&&(e={target:"map"}),this.options=Object.assign({},e);var t=new o.View({center:[-9101767,2822912],zoom:14,projection:this.displayProjection}),r=E({},{logo:!1,controls:[],view:t,layers:[]},e);this.map=new o.Map(r),this.emitter.emit("create",{map:this.map}),this._olView=this.map.getView(),this._addMapListeners()},e.prototype.getContainer=function(){return document.getElementById(this.options.target)},e.prototype.onMapLoad=function(e){return new Promise(function(t){t(e&&e())})},e.prototype.setCenter=function(e){this._olView.setCenter(Object(n.fromLonLat)(e))},e.prototype.setZoom=function(e){this._olView.setZoom(e)},e.prototype.fit=function(e){var t=Object(n.transformExtent)(e,this.lonlatProjection,this.displayProjection);this._olView.fit(t)},e.prototype.setRotation=function(e){this._olView.setRotation(e)},e.prototype.getLayerAdapter=function(t){return e.layerAdapters[t]},e.prototype.getLayer=function(e){return void 0!==this._layers[e]},e.prototype.getLayers=function(){return Object.keys(this._layers)},e.prototype.isLayerOnTheMap=function(e){return this._layers[e].onMap},e.prototype.addLayer=function(e,t,r){var o,n=this;if("string"==typeof e&&(o=this.getLayerAdapter(e)),o){var i=new o(this.map,t),a=i.addLayer(t),u=i.addLayer(t),s=function(e){var o=i.name,a={layer:e,onMap:!1};return r?(a.baseLayer=!0,n._baseLayers.push(o)):a.order=t.order||n._order++,n._layers[o]=a,i};return u.then?u.then(function(e){return s(e)}):Promise.resolve(s(a))}return Promise.reject("No adapter")},e.prototype.removeLayer=function(e){var t=this._layers[e];if(t){if(this.map.removeLayer(t.layer),t.baseLayer){var r=this._baseLayers.indexOf(e);r&&this._baseLayers.splice(r,1)}delete this._layers[e]}},e.prototype.showLayer=function(e){this.toggleLayer(e,!0)},e.prototype.hideLayer=function(e){this.toggleLayer(e,!1)},e.prototype.setLayerOpacity=function(e,t){},e.prototype.getScaleForResolution=function(e,t){return parseFloat(e)*(t*this.IPM*this.DPI)},e.prototype.getResolutionForScale=function(e,t){return parseFloat(e)/(t*this.IPM*this.DPI)},e.prototype.toggleLayer=function(e,t){var r=this,n=function(e,n){t?e instanceof o.Map&&(n.layer.setZIndex(r._length-n.order),e.addLayer(n.layer)):e.removeLayer(n.layer),n.onMap=t},i=this._layers[e];i&&i.onMap!==t&&(this.map?n(this.map,i):this.emitter.once("create",function(e){n(e.map,i)}))},e.prototype.addControl=function(t,r,o){var n;if("string"==typeof t){var i=e.controlAdapters[t];i&&(n=new i(o))}else n=t;if(n)return this.map.addControl(n),n},e.prototype.onMapClick=function(e){var t=Object(n.transform)(e.coordinate,this.displayProjection,this.lonlatProjection),r=t[0],o={lat:t[1],lng:r};this.emitter.emit("click",{latLng:o,pixel:{left:e.pixel[0],top:e.pixel[1]},source:e})},e.prototype.requestGeomString=function(e,t){void 0===t&&(t=5);var r=e.top,o=e.left,n=this.map,i=Object(a.boundingExtent)([n.getCoordinateFromPixel([o-t,r-t]),n.getCoordinateFromPixel([o+t,r+t])]);return(new u.WKT).writeGeometry(Object(s.fromExtent)(i))},e.prototype._addMapListeners=function(){var e=this;this.map.on("click",function(t){e.onMapClick(t)})},e.layerAdapters={IMAGE:d,TILE:C,OSM:L,MARKER:I},e.controlAdapters={ZOOM:i.Zoom,ATTRIBUTION:i.Attribution},e}();t.default=V}]).default});
//# sourceMappingURL=ol-map-adapter.js.map